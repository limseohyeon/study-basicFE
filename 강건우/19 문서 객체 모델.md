# 문서 객체 모델 정리


## 1. 문서 객체 모델(DOM) 알아보기

### 1-1. DOM이란?

**DOM (Document Object Model)**  
HTML 문서를 자바스크립트로 조작하기 위해 브라우저가 제공하는 인터페이스

- HTML의 각 요소를 **객체**로 변환
- 트리 구조로 계층적으로 표현
- 자바스크립트에서 HTML 조작 가능

```
document
├── html
│   ├── head
│   │   ├── title
│   │   └── meta
│   └── body
│       ├── div
│       │   └── p
│       └── button
```

### 1-2. 노드(Node)와 요소(Element)

**노드(Node)**  
DOM 트리의 모든 개체 (텍스트, 주석, 요소 등)

**요소(Element)**  
HTML 태그로 표현되는 노드 (중요)

```javascript
const div = document.querySelector("div");

// 요소 노드
console.log(div.nodeType); // 1

// 텍스트 노드
console.log(div.firstChild.nodeType); // 3
```

### 1-3. DOM 구조와 관계

```html
<div id="parent">
  <p>첫 번째 자식</p>
  <p>두 번째 자식</p>
</div>
```

```javascript
const parent = document.querySelector("#parent");

// 자식 노드 접근
console.log(parent.childNodes);    // 모든 노드 (텍스트 포함)
console.log(parent.children);      // 요소 노드만

// 첫 번째/마지막 자식
console.log(parent.firstChild);    // 텍스트 노드 가능
console.log(parent.firstElementChild); // 첫 요소

// 부모 노드 접근
console.log(parent.parentNode);
console.log(parent.parentElement);

// 형제 노드 접근
const first = parent.firstElementChild;
console.log(first.nextElementSibling);  // 두 번째 p
console.log(first.previousElementSibling); // null (첫 번째니까)
```

---

## 2. DOM 요소에 접근하고 내용 수정하기

### 2-1. DOM 요소 선택하기

1) **`getElementById()`** - ID로 선택 (하나만)

```javascript
const title = document.getElementById("title");
```

2) **`getElementsByClassName()`** - 클래스로 선택 (여러 개, HTMLCollection)

```javascript
const items = document.getElementsByClassName("item");
// 배열처럼 쓸 수 있지만 실제 배열은 아님
```

3) **`getElementsByTagName()`** - 태그명으로 선택 (여러 개)

```javascript
const paragraphs = document.getElementsByTagName("p");
```

4) **`querySelector()`** - CSS 선택자로 선택 (첫 번째 하나만)

```javascript
const title = document.querySelector("#title");
const item = document.querySelector(".item");
const firstP = document.querySelector("p");
const specific = document.querySelector("div.container > p");
```

5) **`querySelectorAll()`** - CSS 선택자로 선택 (모두, NodeList)

```javascript
const allItems = document.querySelectorAll(".item");
const allPs = document.querySelectorAll("p");

allItems.forEach((item) => {
  console.log(item);
});
```

**선택 메서드 비교**

| 메서드 | 반환 | 특징 |
|--------|------|------|
| `getElementById()` | Element | 가장 빠름 (ID는 유일) |
| `querySelector()` | Element | 첫 번째만 |
| `querySelectorAll()` | NodeList | 모두 선택, 유연함 |
| `getElementsBy*()` | HTMLCollection | 실시간 반영 (거의 안 씀) |

→ **권장**: `querySelector`, `querySelectorAll` 사용

### 2-2. 요소 내용 수정하기

1) **`textContent`** - 순수 텍스트만

```javascript
const p = document.querySelector("p");

console.log(p.textContent);  // 읽기
p.textContent = "새로운 텍스트"; // 쓰기

// HTML 태그는 해석되지 않음
p.textContent = "<b>bold</b>";  // 그대로 출력: <b>bold</b>
```

2) **`innerHTML`** - HTML 포함해서 변경

```javascript
const p = document.querySelector("p");

p.innerHTML = "<b>굵은 글씨</b>";  // HTML 적용됨
```

**주의**: XSS(크로스사이트 스크립팅) 보안 위험  
사용자 입력을 직접 `innerHTML`에 넣으면 악성 스크립트 실행 가능

```javascript
// 위험: 사용자 입력
const userInput = "<img src=x onerror='alert(\"해킹\")'>";
p.innerHTML = userInput;  // 위험!

// 안전: textContent 사용
p.textContent = userInput;  // 안전
```

### 2-3. 요소의 속성(Attribute) 접근/수정

```javascript
const img = document.querySelector("img");

// 속성값 읽기
console.log(img.src);
console.log(img.alt);

// 속성값 변경
img.src = "new.jpg";
img.alt = "새로운 이미지";

// data 속성
const btn = document.querySelector("button");
console.log(btn.dataset.id);     // data-id 값
btn.dataset.id = "123";
```

`getAttribute`, `setAttribute` 메서드도 사용 가능:

```javascript
const a = document.querySelector("a");

const href = a.getAttribute("href");
a.setAttribute("href", "https://example.com");
a.removeAttribute("href");
```

### 2-4. CSS 스타일 변경하기

```javascript
const box = document.querySelector(".box");

// 인라인 스타일 변경
box.style.color = "red";
box.style.backgroundColor = "blue";  // 카멜케이스
box.style.padding = "10px";
box.style.display = "none";

// 여러 스타일 한 번에
box.style.cssText = "color: red; background-color: blue; padding: 10px;";
```

CSS 속성명이 `background-color` 같으면 자바스크립트에서는 `backgroundColor`로 변경

---

## 3. DOM에서 이벤트 처리하기

### 3-1. 이벤트 등록 (복습)

**권장 방식: `addEventListener()`**

```javascript
const btn = document.querySelector("#myBtn");

btn.addEventListener("click", function (event) {
  console.log("버튼 클릭됨");
});

// 화살표 함수로도 가능
btn.addEventListener("click", (event) => {
  console.log("버튼 클릭됨");
});
```

### 3-2. 이벤트 객체(Event Object) 활용

이벤트 발생 시 브라우저가 핸들러에 자동으로 전달

```javascript
const btn = document.querySelector("button");

btn.addEventListener("click", function (event) {
  console.log(event.type);        // "click"
  console.log(event.target);      // 클릭한 요소
  console.log(event.currentTarget); // 핸들러 걸린 요소
});
```

**마우스 이벤트**

```javascript
document.addEventListener("mousemove", (e) => {
  console.log(`마우스: ${e.clientX}, ${e.clientY}`);
});

document.addEventListener("click", (e) => {
  console.log(`클릭 좌표: ${e.pageX}, ${e.pageY}`);
});
```

**키보드 이벤트**

```javascript
const input = document.querySelector("input");

input.addEventListener("keydown", (e) => {
  console.log(e.key);   // "a", "Enter", "ArrowUp" 등
  console.log(e.code);  // "KeyA", "Enter", "ArrowUp" 등
});

// Enter 키 감지
input.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    console.log("입력 완료:", input.value);
  }
});
```

**폼 이벤트**

```javascript
const form = document.querySelector("form");
const input = document.querySelector("input");

// 입력할 때마다
input.addEventListener("input", (e) => {
  console.log("현재 값:", e.target.value);
});

// 변경 완료 (포커스 해제)
input.addEventListener("change", (e) => {
  console.log("최종 값:", e.target.value);
});

// 폼 제출
form.addEventListener("submit", (e) => {
  e.preventDefault(); // 기본 동작(새로고침) 차단
  console.log("폼 제출 처리");
});
```

### 3-3. 이벤트 전파 제어

**버블링(Bubbling)** - 안쪽에서 바깥쪽으로 이벤트 전파

```html
<div id="outer">
  <button id="btn">클릭</button>
</div>

<script>
  const outer = document.querySelector("#outer");
  const btn = document.querySelector("#btn");

  btn.addEventListener("click", () => {
    console.log("버튼 클릭");
  });

  outer.addEventListener("click", () => {
    console.log("div 클릭"); // 버튼 클릭 후에도 실행됨
  });
</script>
```

**버블링 중단**

```javascript
btn.addEventListener("click", (e) => {
  e.stopPropagation(); // 이벤트 전파 중단
  console.log("버튼 클릭");
});
```

**기본 동작 취소**

```javascript
const link = document.querySelector("a");

link.addEventListener("click", (e) => {
  e.preventDefault(); // 기본 동작(페이지 이동) 취소
  console.log("링크 클릭했지만 이동 안 함");
});
```

### 3-4. 위임(Event Delegation) - 부모에서 여러 자식 처리

동적으로 추가되는 요소들의 이벤트를 효율적으로 처리

```html
<ul id="list">
  <li>항목 1</li>
  <li>항목 2</li>
  <!-- 나중에 동적 추가되는 항목들 -->
</ul>
```

```javascript
const list = document.querySelector("#list");

// 리스트 전체에 이벤트 등록
list.addEventListener("click", (e) => {
  // 클릭된 요소가 li 인지 확인
  if (e.target.tagName === "LI") {
    console.log("항목 클릭:", e.target.textContent);
  }
});

// 나중에 동적으로 항목 추가해도 작동
const newItem = document.createElement("li");
newItem.textContent = "항목 3";
list.appendChild(newItem);
```

---

## 4. DOM에서 노드 추가/삭제하기

### 4-1. 요소 생성하기

```javascript
// 새로운 요소 생성
const p = document.createElement("p");
p.textContent = "새로운 문단";

const div = document.createElement("div");
div.className = "container";
div.innerHTML = "<h1>제목</h1>";
```

### 4-2. 요소 추가하기

1) **`appendChild()`** - 마지막 자식으로 추가

```javascript
const parent = document.querySelector(".container");
const p = document.createElement("p");
p.textContent = "새 문단";

parent.appendChild(p);
```

2) **`insertBefore()`** - 특정 자식 앞에 추가

```javascript
const parent = document.querySelector(".container");
const firstChild = parent.firstElementChild;
const newElement = document.createElement("div");

parent.insertBefore(newElement, firstChild);  // 첫 번째로 추가
```

3) **`insertAdjacentHTML()`** - 문자열로 HTML 삽입 (편함)

```javascript
const div = document.querySelector("div");

div.insertAdjacentHTML("beforebegin", "<p>앞에 추가</p>");
div.insertAdjacentHTML("afterbegin", "<p>안에 앞</p>");
div.insertAdjacentHTML("beforeend", "<p>안에 뒤</p>");
div.insertAdjacentHTML("afterend", "<p>뒤에 추가</p>");
```

```
beforebegin - 요소 앞
<div>
  afterbegin - 요소 안 앞
  내용...
  beforeend - 요소 안 뒤
</div>
afterend - 요소 뒤
```

### 4-3. 요소 삭제하기

1) **`removeChild()`** - 자식 요소 삭제

```javascript
const parent = document.querySelector(".container");
const child = parent.firstElementChild;

parent.removeChild(child);
```

2) **`remove()`** - 요소 자신을 삭제 (더 간단)

```javascript
const element = document.querySelector(".item");
element.remove();
```

3) **`replaceChild()`** - 요소 교체

```javascript
const parent = document.querySelector(".container");
const oldElement = parent.firstElementChild;
const newElement = document.createElement("div");

parent.replaceChild(newElement, oldElement);
```

### 4-4. 실제 예제 - 할일 목록

```html
<div id="app">
  <input type="text" id="input" placeholder="할일 입력">
  <button id="addBtn">추가</button>
  <ul id="todoList"></ul>
</div>
```

```javascript
const input = document.querySelector("#input");
const addBtn = document.querySelector("#addBtn");
const todoList = document.querySelector("#todoList");

addBtn.addEventListener("click", () => {
  const text = input.value;

  if (text.trim() === "") {
    alert("할일을 입력하세요");
    return;
  }

  // 새로운 리스트 항목 생성
  const li = document.createElement("li");

  // 텍스트와 삭제 버튼
  const span = document.createElement("span");
  span.textContent = text;

  const deleteBtn = document.createElement("button");
  deleteBtn.textContent = "삭제";

  deleteBtn.addEventListener("click", () => {
    li.remove();  // 항목 삭제
  });

  li.appendChild(span);
  li.appendChild(deleteBtn);
  todoList.appendChild(li);

  input.value = "";  // 입력 필드 초기화
});
```

---

## 5. Class 속성 추가/삭제/수정하기

### 5-1. Class 조작 기본

1) **`className`** - 전체 클래스 교체 (한 번에 하나만)

```javascript
const box = document.querySelector(".box");

console.log(box.className);  // "box active"
box.className = "new-class";  // 기존 클래스 모두 제거, 새 클래스로 변경
```

기존 클래스가 전부 사라짐

2) **`classList`** - 개별 클래스 제어 (권장)

```javascript
const box = document.querySelector(".box");

// 클래스 추가
box.classList.add("active");
box.classList.add("highlight", "primary"); // 여러 개 한 번에

// 클래스 제거
box.classList.remove("active");
box.classList.remove("highlight", "primary");

// 클래스 토글 (있으면 제거, 없으면 추가)
box.classList.toggle("active");

// 클래스 포함 여부 확인
console.log(box.classList.contains("active")); // true/false
```

### 5-2. `classList` 실제 활용

**토글 버튼 예제**

```html
<button id="toggleBtn">토글</button>
<div id="box" class="box">내용</div>

<style>
  .box {
    background-color: white;
    padding: 20px;
  }
  .box.dark {
    background-color: #333;
    color: white;
  }
</style>
```

```javascript
const toggleBtn = document.querySelector("#toggleBtn");
const box = document.querySelector("#box");

toggleBtn.addEventListener("click", () => {
  box.classList.toggle("dark");
});
```

**다크 모드 토글**

```javascript
const toggleBtn = document.querySelector("#darkModeToggle");

toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("dark-mode");

  // 토글 상태 저장
  const isDark = document.body.classList.contains("dark-mode");
  localStorage.setItem("theme", isDark ? "dark" : "light");
});

// 페이지 로드 시 저장된 테마 적용
const savedTheme = localStorage.getItem("theme");
if (savedTheme === "dark") {
  document.body.classList.add("dark-mode");
}
```

**상태 클래스로 UI 제어**

```html
<input type="email" id="emailInput">
<div id="error" class="error-message hidden">
  이메일 형식이 올바르지 않습니다.
</div>

<style>
  .error-message {
    color: red;
    margin-top: 5px;
  }
  .error-message.hidden {
    display: none;
  }
</style>
```

```javascript
const emailInput = document.querySelector("#emailInput");
const errorMsg = document.querySelector("#error");

emailInput.addEventListener("change", (e) => {
  const email = e.target.value;
  const isValid = email.includes("@") && email.includes(".");

  if (isValid) {
    errorMsg.classList.add("hidden");
  } else {
    errorMsg.classList.remove("hidden");
  }
});
```

### 5-3. `classList` 메서드 정리

| 메서드 | 기능 |
|--------|------|
| `add()` | 클래스 추가 |
| `remove()` | 클래스 제거 |
| `toggle()` | 클래스 토글 (있으면 제거, 없으면 추가) |
| `contains()` | 클래스 포함 여부 (true/false) |
| `replace()` | 클래스 교체 |

```javascript
box.classList.replace("old-class", "new-class");
```

---

## 6. 실제 프로젝트 예제 - 동적 카드 생성

```html
<div id="app">
  <input type="text" id="cardTitle" placeholder="카드 제목">
  <input type="text" id="cardContent" placeholder="카드 내용">
  <button id="addCardBtn">카드 추가</button>
  
  <div id="cardsContainer" class="cards-container"></div>
</div>

<style>
  .cards-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 10px;
    margin-top: 20px;
  }

  .card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    background-color: white;
  }

  .card.highlight {
    background-color: #ffffcc;
    border-color: #ffcc00;
  }

  .card h3 {
    margin: 0 0 10px 0;
  }

  .card-controls {
    margin-top: 10px;
    display: flex;
    gap: 5px;
  }

  .card-controls button {
    padding: 5px 10px;
    cursor: pointer;
  }

  .card.deleted {
    opacity: 0.5;
    text-decoration: line-through;
  }
</style>
```

```javascript
const cardTitle = document.querySelector("#cardTitle");
const cardContent = document.querySelector("#cardContent");
const addCardBtn = document.querySelector("#addCardBtn");
const cardsContainer = document.querySelector("#cardsContainer");

addCardBtn.addEventListener("click", () => {
  const title = cardTitle.value;
  const content = cardContent.value;

  if (!title || !content) {
    alert("제목과 내용을 모두 입력하세요");
    return;
  }

  // 카드 요소 생성
  const card = document.createElement("div");
  card.classList.add("card");

  const h3 = document.createElement("h3");
  h3.textContent = title;

  const p = document.createElement("p");
  p.textContent = content;

  // 버튼 컨테이너
  const controls = document.createElement("div");
  controls.classList.add("card-controls");

  // 강조 버튼
  const highlightBtn = document.createElement("button");
  highlightBtn.textContent = "강조";
  highlightBtn.addEventListener("click", () => {
    card.classList.toggle("highlight");
  });

  // 삭제 버튼
  const deleteBtn = document.createElement("button");
  deleteBtn.textContent = "삭제";
  deleteBtn.addEventListener("click", () => {
    card.remove();
  });

  controls.appendChild(highlightBtn);
  controls.appendChild(deleteBtn);

  card.appendChild(h3);
  card.appendChild(p);
  card.appendChild(controls);

  cardsContainer.appendChild(card);

  // 입력 필드 초기화
  cardTitle.value = "";
  cardContent.value = "";
  cardTitle.focus();
});
```

---

## 요약 테이블

| 기능 | 메서드/프로퍼티 | 예시 |
|------|-----------------|------|
| 요소 선택 | `querySelector()` | `document.querySelector(".item")` |
| 여러 요소 선택 | `querySelectorAll()` | `document.querySelectorAll("p")` |
| 텍스트 변경 | `textContent` | `p.textContent = "새 텍스트"` |
| HTML 변경 | `innerHTML` | `div.innerHTML = "<b>bold</b>"` |
| 스타일 변경 | `style` | `box.style.color = "red"` |
| 속성 접근 | `getAttribute()` | `img.getAttribute("src")` |
| 속성 변경 | `setAttribute()` | `img.setAttribute("src", "new.jpg")` |
| 요소 생성 | `createElement()` | `document.createElement("div")` |
| 요소 추가 | `appendChild()` | `parent.appendChild(child)` |
| 요소 삭제 | `remove()` | `element.remove()` |
| 클래스 추가 | `classList.add()` | `box.classList.add("active")` |
| 클래스 제거 | `classList.remove()` | `box.classList.remove("active")` |
| 클래스 토글 | `classList.toggle()` | `box.classList.toggle("active")` |
| 이벤트 등록 | `addEventListener()` | `btn.addEventListener("click", fn)` |
| 이벤트 전파 중단 | `stopPropagation()` | `event.stopPropagation()` |
| 기본 동작 취소 | `preventDefault()` | `event.preventDefault()` |

---
